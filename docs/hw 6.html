<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="David Kim">

<title>DATA304-hw5-Portfolio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="hw 6_files/libs/clipboard/clipboard.min.js"></script>
<script src="hw 6_files/libs/quarto-html/quarto.js"></script>
<script src="hw 6_files/libs/quarto-html/popper.min.js"></script>
<script src="hw 6_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hw 6_files/libs/quarto-html/anchor.min.js"></script>
<link href="hw 6_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hw 6_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hw 6_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hw 6_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hw 6_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DATA304-hw5-Portfolio</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>David Kim </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> urllib.request <span class="im">import</span> urlopen</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> vega_datasets <span class="im">import</span> data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="percent-of-men-and-women-in-various-occupations-1950-and-2000." class="level2">
<h2 class="anchored" data-anchor-id="percent-of-men-and-women-in-various-occupations-1950-and-2000.">Percent of men and women in various occupations 1950 and 2000.</h2>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (graphic 1)Percent of men and women in various occupations 1950 and 2000.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#load data</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>jobs_url2 <span class="op">=</span> <span class="st">"https://cdn.jsdelivr.net/npm/vega-datasets@2.8.0/data/jobs.json"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>jobs2 <span class="op">=</span> pd.read_json(jobs_url2)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable JSON data transformer for handling larger datasets</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>alt.data_transformers.enable(<span class="st">'json'</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>alt.Chart(jobs2).transform_pivot(</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'year'</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    value<span class="op">=</span><span class="st">'perc'</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    groupby <span class="op">=</span> [<span class="st">"job"</span>, <span class="st">"sex"</span>]).mark_point(filled<span class="op">=</span><span class="va">True</span>).encode(</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>alt.X(<span class="st">'1950:Q'</span>, scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'symlog'</span>,constant <span class="op">=</span> <span class="fl">0.0001</span>)),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>alt.Y(<span class="st">'2000:Q'</span>, scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'symlog'</span>, constant <span class="op">=</span> <span class="fl">0.0001</span>)),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">=</span>[<span class="st">'job'</span>, <span class="st">'sex'</span>],</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    column <span class="op">=</span> <span class="st">'sex:N'</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>).properties(</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="dv">150</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">150</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>).interactive()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">

<style>
  #altair-viz-b17683c0b76a43f488ad387367b5016f.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-b17683c0b76a43f488ad387367b5016f.vega-embed details,
  #altair-viz-b17683c0b76a43f488ad387367b5016f.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-b17683c0b76a43f488ad387367b5016f"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-b17683c0b76a43f488ad387367b5016f") {
      outputDiv = document.getElementById("altair-viz-b17683c0b76a43f488ad387367b5016f");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"url": "altair-data-ac16e648372efb4e869f61bb9ce13513.json", "format": {"type": "json"}}, "mark": {"type": "point", "filled": true}, "encoding": {"column": {"field": "sex", "type": "nominal"}, "tooltip": [{"field": "job", "type": "nominal"}, {"field": "sex", "type": "nominal"}], "x": {"field": "1950", "scale": {"constant": 0.0001, "type": "symlog"}, "type": "quantitative"}, "y": {"field": "2000", "scale": {"constant": 0.0001, "type": "symlog"}, "type": "quantitative"}}, "height": 150, "params": [{"name": "param_1", "select": {"type": "interval", "encodings": ["x", "y"]}, "bind": "scales"}], "transform": [{"pivot": "year", "value": "perc", "groupby": ["job", "sex"]}], "width": 150, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json"}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="percent-of-men-and-women-in-farmer-and-professor-occupations-over-time." class="level2">
<h2 class="anchored" data-anchor-id="percent-of-men-and-women-in-farmer-and-professor-occupations-over-time.">Percent of men and women in farmer and professor occupations over time.</h2>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Percent of men and women in farmer and professor occupations over time.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data directly from URL</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>jobs_url <span class="op">=</span> <span class="st">"https://cdn.jsdelivr.net/npm/vega-datasets@2.8.0/data/jobs.json"</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>jobs <span class="op">=</span> pd.read_json(jobs_url)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable JSON data transformer for handling larger datasets</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>alt.data_transformers.enable(<span class="st">'json'</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the chart</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>chart <span class="op">=</span> alt.Chart(jobs).transform_filter(</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    (alt.datum.job <span class="op">==</span> <span class="st">"Farmer"</span>) <span class="op">|</span> (alt.datum.job <span class="op">==</span> <span class="st">"Professor"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>).mark_line(point<span class="op">=</span><span class="va">True</span>).encode(</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'year:N'</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>alt.Y(<span class="st">'perc:Q'</span> ,scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'symlog'</span>, constant <span class="op">=</span> <span class="fl">0.0001</span>)),</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>alt.Color(<span class="st">'job:N'</span>, title<span class="op">=</span><span class="st">"Job"</span>),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    row <span class="op">=</span> <span class="st">'sex:N'</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>).interactive()</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>chart.properties(</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Gender Disparities in Farmer and Professor Occupations Over Time"</span>,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="dv">600</span>,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">100</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<style>
  #altair-viz-7c011caa4f034b7ca226fec472b7907f.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-7c011caa4f034b7ca226fec472b7907f.vega-embed details,
  #altair-viz-7c011caa4f034b7ca226fec472b7907f.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-7c011caa4f034b7ca226fec472b7907f"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-7c011caa4f034b7ca226fec472b7907f") {
      outputDiv = document.getElementById("altair-viz-7c011caa4f034b7ca226fec472b7907f");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"url": "altair-data-ac16e648372efb4e869f61bb9ce13513.json", "format": {"type": "json"}}, "mark": {"type": "line", "point": true}, "encoding": {"color": {"field": "job", "title": "Job", "type": "nominal"}, "row": {"field": "sex", "type": "nominal"}, "x": {"field": "year", "type": "nominal"}, "y": {"field": "perc", "scale": {"constant": 0.0001, "type": "symlog"}, "type": "quantitative"}}, "height": 100, "params": [{"name": "param_2", "select": {"type": "interval", "encodings": ["x", "y"]}, "bind": "scales"}], "title": "Gender Disparities in Farmer and Professor Occupations Over Time", "transform": [{"filter": "((datum.job === 'Farmer') || (datum.job === 'Professor'))"}], "width": 600, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json"}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="number-of-women-bakers-exceeds-men-bakers-since-1950" class="level2">
<h2 class="anchored" data-anchor-id="number-of-women-bakers-exceeds-men-bakers-since-1950">Number of women bakers exceeds men bakers since 1950</h2>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data directly from URL</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>jobs_url3 <span class="op">=</span> <span class="st">"https://cdn.jsdelivr.net/npm/vega-datasets@2.8.0/data/jobs.json"</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>jobs3 <span class="op">=</span> pd.read_json(jobs_url3)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#print(jobs[0:4])</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable JSON data transformer for handling larger datasets</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>alt.data_transformers.enable(<span class="st">'json'</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the chart</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>chart <span class="op">=</span> alt.Chart(jobs).transform_filter(</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    (alt.datum.job <span class="op">==</span> <span class="st">"Baker"</span>) </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>).mark_line(point<span class="op">=</span><span class="va">True</span>).encode(</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'year:N'</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>alt.Y(<span class="st">'count:Q'</span> ,scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'linear'</span>)),</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>alt.Color(<span class="st">'sex:N'</span>, title<span class="op">=</span><span class="st">"sex"</span>),</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>).interactive()</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>chart.properties(</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="dv">600</span>,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">100</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<style>
  #altair-viz-82120d017ec84b5e9ea6c45a64980245.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-82120d017ec84b5e9ea6c45a64980245.vega-embed details,
  #altair-viz-82120d017ec84b5e9ea6c45a64980245.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-82120d017ec84b5e9ea6c45a64980245"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-82120d017ec84b5e9ea6c45a64980245") {
      outputDiv = document.getElementById("altair-viz-82120d017ec84b5e9ea6c45a64980245");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"url": "altair-data-ac16e648372efb4e869f61bb9ce13513.json", "format": {"type": "json"}}, "mark": {"type": "line", "point": true}, "encoding": {"color": {"field": "sex", "title": "sex", "type": "nominal"}, "x": {"field": "year", "type": "nominal"}, "y": {"field": "count", "scale": {"type": "linear"}, "type": "quantitative"}}, "height": 100, "params": [{"name": "param_3", "select": {"type": "interval", "encodings": ["x", "y"]}, "bind": "scales"}], "transform": [{"filter": "(datum.job === 'Baker')"}], "width": 600, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json"}, {"mode": "vega-lite"});
</script>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>world2_url <span class="op">=</span> <span class="st">'https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json'</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>aux_dat <span class="op">=</span> <span class="st">'https://cdn.jsdelivr.net/npm/vega-datasets@1.29.0/data/gapminder.json'</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>aux_co <span class="op">=</span> <span class="st">'https://cdn.jsdelivr.net/npm/vega-datasets@1.29.0/data/gapminder-health-income.csv'</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>world2 <span class="op">=</span> json.load(urlopen(world2_url))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>auxdata <span class="op">=</span> json.load(urlopen(aux_dat))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(world2))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(world2.keys())</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>world <span class="op">=</span> alt.topo_feature(world2_url, feature<span class="op">=</span><span class="st">'countries'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'dict'&gt;
dict_keys(['type', 'objects', 'arcs', 'bbox', 'transform'])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>country_names <span class="op">=</span> [ p[<span class="st">'properties'</span>][<span class="st">'name'</span>] </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> p <span class="kw">in</span> world2[<span class="st">'objects'</span>][<span class="st">'countries'</span>][<span class="st">'geometries'</span>] ]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(country_names[<span class="dv">0</span>:<span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['Fiji', 'Tanzania', 'W. Sahara', 'Canada', 'United States of America']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#gapminder = pd.read_json(data.gapminder.url)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>gapminder <span class="op">=</span> pd.read_csv(aux_co)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>common_names <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(country_names) <span class="op">&amp;</span> <span class="bu">set</span>(gapminder[<span class="st">'country'</span>]))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>missing_names <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(gapminder[<span class="st">'country'</span>]) <span class="op">-</span> <span class="bu">set</span>(country_names))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>extra_names <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(country_names) <span class="op">-</span> <span class="bu">set</span>(gapminder[<span class="st">'country'</span>]))</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># names in gapminder and in map data</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#print("in common:", len(common_names), common_names)     </span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># names in gapminder but not in map data</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"missing in map:"</span>, <span class="bu">len</span>(missing_names), missing_names)    </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># names in the map data but not in gapminder</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"extra in map"</span>, <span class="bu">len</span>(extra_names), extra_names)      </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>missing in map: 38 ['Congo, Dem. Rep.', 'Dominican Republic', 'Central African Republic', 'Solomon Islands', 'Samoa', 'Comoros', 'Bosnia and Herzegovina', 'Lao', 'West Bank and Gaza', 'Czech Republic', 'Sao Tome and Principe', 'Slovak Republic', 'Singapore', 'Cape Verde', 'South Sudan', 'United States', 'Macedonia, FYR', 'St. Vincent and the Grenadines', 'Congo, Rep.', 'Equatorial Guinea', 'Grenada', 'St. Lucia', 'Micronesia, Fed. Sts.', 'Andorra', 'Maldives', 'Seychelles', 'Kiribati', 'Dominica', 'Bahrain', 'Tonga', 'Swaziland', 'Mauritius', 'Barbados', 'Antigua and Barbuda', 'Marshall Islands', 'Kyrgyz Republic', 'Malta', "Cote d'Ivoire"]
extra in map 28 ['Kyrgyzstan', 'Czechia', 'W. Sahara', 'Somaliland', 'United States of America', 'Bosnia and Herz.', 'Dominican Rep.', 'Palestine', 'Laos', 'Antarctica', "Côte d'Ivoire", 'New Caledonia', 'Macedonia', 'Eq. Guinea', 'Solomon Is.', 'Slovakia', 'Greenland', 'Central African Rep.', 'S. Sudan', 'N. Cyprus', 'Falkland Is.', 'Kosovo', 'eSwatini', 'Congo', 'Taiwan', 'Fr. S. Antarctic Lands', 'Puerto Rico', 'Dem. Rep. Congo']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Existing mapping dictionary</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>flipped_mapping_dict <span class="op">=</span> {</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Bosnia and Herz.'</span>: <span class="st">'Bosnia and Herzegovina'</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Maldives'</span>: <span class="st">'Maldives'</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'United States of America'</span>: <span class="st">'United States'</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Dem. Rep. Congo'</span>: <span class="st">'Congo, Dem. Rep.'</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Laos'</span>: <span class="st">'Lao'</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Central African Rep.'</span>: <span class="st">'Central African Republic'</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Congo'</span>: <span class="st">'Congo, Rep.'</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Czechia'</span>: <span class="st">'Czech Republic'</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'S. Sudan'</span>: <span class="st">'South Sudan'</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Eq. Guinea'</span>: <span class="st">'Equatorial Guinea'</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Kiribati'</span>: <span class="st">'Kiribati'</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sao Tome and Principe'</span>: <span class="st">'Sao Tome and Principe'</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Solomon Is.'</span>: <span class="st">'Solomon Islands'</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Côte d'Ivoire"</span>: <span class="st">"Cote d'Ivoire"</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Macedonia'</span>: <span class="st">'Macedonia, FYR'</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Micronesia, Fed. Sts.'</span>: <span class="st">'Micronesia, Fed. Sts.'</span>,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'eSwatini'</span>: <span class="st">'Swaziland'</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Slovakia'</span>: <span class="st">'Slovak Republic'</span>,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Swaziland'</span>: <span class="st">'eSwatini'</span>,</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Solomon Islands'</span>: <span class="st">'Solomon Is.'</span>,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Equatorial Guinea'</span>: <span class="st">'Eq. Guinea'</span>,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Macedonia, FYR'</span>: <span class="st">'Macedonia'</span>,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Fr. S. Antarctic Lands'</span>: <span class="st">'Fr. S. Antarctic Lands'</span>,</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Czech Republic'</span>: <span class="st">'Czechia'</span>,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Somaliland'</span>: <span class="st">'Somaliland'</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Slovak Republic'</span>: <span class="st">'Slovakia'</span>,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Antarctica'</span>: <span class="st">'Antarctica'</span>,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Falkland Islands'</span>: <span class="st">'Falkland Is.'</span>,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Central African Republic'</span>: <span class="st">'Central African Rep.'</span>,</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">'South Sudan'</span>: <span class="st">'S. Sudan'</span>,</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'United States'</span>: <span class="st">'United States of America'</span>,</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Kyrgyzstan'</span>: <span class="st">'Kyrgyzstan'</span>,</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Bosnia and Herzegovina'</span>: <span class="st">'Bosnia and Herz.'</span>,</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Dominican Republic'</span>: <span class="st">'Dominican Rep.'</span>,</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Congo, Dem. Rep.'</span>: <span class="st">'Dem. Rep. Congo'</span>,</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cote d'Ivoire"</span>: <span class="st">"Côte d'Ivoire"</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>gapminder[<span class="st">'country'</span>] <span class="op">=</span> gapminder[<span class="st">'country'</span>].replace(flipped_mapping_dict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="choropleth-map-of-the-world-based-on-income" class="level2">
<h2 class="anchored" data-anchor-id="choropleth-map-of-the-world-based-on-income">Choropleth map of the World based on income</h2>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>world <span class="op">=</span> alt.topo_feature(world2_url, feature<span class="op">=</span><span class="st">'countries'</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>world_map <span class="op">=</span> alt.Chart(world).mark_geoshape().encode(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    tooltip <span class="op">=</span> [<span class="st">"income:Q"</span>, <span class="st">"properties.name:N"</span>]</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>world_2<span class="op">=</span> world_map.transform_lookup(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  lookup<span class="op">=</span><span class="st">'properties.name'</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  from_<span class="op">=</span>alt.LookupData(gapminder, <span class="st">'country'</span>, [<span class="st">'income'</span>])</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  ).encode(</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    fill <span class="op">=</span> <span class="st">"income:Q"</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    stroke <span class="op">=</span> <span class="st">"income:Q"</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    ).properties(width <span class="op">=</span> <span class="dv">600</span>, height <span class="op">=</span> <span class="dv">400</span>).project(</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">type</span><span class="op">=</span><span class="st">'equalEarth'</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>world_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<style>
  #altair-viz-832ed0cc68a041a696502ffc4d5b2fa2.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-832ed0cc68a041a696502ffc4d5b2fa2.vega-embed details,
  #altair-viz-832ed0cc68a041a696502ffc4d5b2fa2.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-832ed0cc68a041a696502ffc4d5b2fa2"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-832ed0cc68a041a696502ffc4d5b2fa2") {
      outputDiv = document.getElementById("altair-viz-832ed0cc68a041a696502ffc4d5b2fa2");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"url": "https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json", "format": {"feature": "countries", "type": "topojson"}}, "mark": {"type": "geoshape"}, "encoding": {"fill": {"field": "income", "type": "quantitative"}, "stroke": {"field": "income", "type": "quantitative"}, "tooltip": [{"field": "income", "type": "quantitative"}, {"field": "properties.name", "type": "nominal"}]}, "height": 400, "projection": {"type": "equalEarth"}, "transform": [{"lookup": "properties.name", "from": {"data": {"url": "altair-data-eb8612aa7c8bb07026fbbb8690caa8f8.json", "format": {"type": "json"}}, "key": "country", "fields": ["income"]}}], "width": 600, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json"}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="united-states-state-map" class="level2">
<h2 class="anchored" data-anchor-id="united-states-state-map">United States state map</h2>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>us_url <span class="op">=</span> <span class="st">"https://cdn.jsdelivr.net/npm/us-atlas@3/states-10m.json"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>airport_url <span class="op">=</span> <span class="st">"https://cdn.jsdelivr.net/npm/vega-datasets@1.29.0/data/airports.csv"</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>read_url <span class="op">=</span> json.load(urlopen(us_url))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>airport <span class="op">=</span> pd.read_csv(airport_url)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>states <span class="op">=</span> alt.topo_feature(us_url, feature <span class="op">=</span> <span class="st">'states'</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>state_map <span class="op">=</span> alt.Chart(states).mark_geoshape(</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    fill <span class="op">=</span> <span class="st">'transparent'</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    stroke <span class="op">=</span> <span class="st">'steelblue'</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>).encode(tooltip <span class="op">=</span> [<span class="st">"properties.name:N"</span>,<span class="st">"airport_count:Q"</span>]).project(<span class="st">'albersUsa'</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>state_map.properties(width <span class="op">=</span> <span class="dv">500</span>, height <span class="op">=</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

<style>
  #altair-viz-2d29389e50cf42cb852d04b70566f4fc.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-2d29389e50cf42cb852d04b70566f4fc.vega-embed details,
  #altair-viz-2d29389e50cf42cb852d04b70566f4fc.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-2d29389e50cf42cb852d04b70566f4fc"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-2d29389e50cf42cb852d04b70566f4fc") {
      outputDiv = document.getElementById("altair-viz-2d29389e50cf42cb852d04b70566f4fc");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"url": "https://cdn.jsdelivr.net/npm/us-atlas@3/states-10m.json", "format": {"feature": "states", "type": "topojson"}}, "mark": {"type": "geoshape", "fill": "transparent", "stroke": "steelblue"}, "encoding": {"tooltip": [{"field": "properties.name", "type": "nominal"}, {"field": "airport_count", "type": "quantitative"}]}, "height": 300, "projection": {"type": "albersUsa"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json"}, {"mode": "vega-lite"});
</script>
</div>
</div>
<section id="check-if-the-state-name-in-map-datast-matches-the-state-name-in-auxiliary-data." class="level4">
<h4 class="anchored" data-anchor-id="check-if-the-state-name-in-map-datast-matches-the-state-name-in-auxiliary-data.">Check if the state name in map datast matches the state name in auxiliary data.</h4>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>state_names <span class="op">=</span> [ p[<span class="st">'properties'</span>][<span class="st">'name'</span>] </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> p <span class="kw">in</span> read_url[<span class="st">'objects'</span>][<span class="st">'states'</span>][<span class="st">'geometries'</span>] ]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(state_names[<span class="dv">0</span>:<span class="dv">5</span>])</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>common_names2 <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(state_names) <span class="op">&amp;</span> <span class="bu">set</span>(airport[<span class="st">'state'</span>]))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>missing_names2 <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(airport[<span class="st">'state'</span>]) <span class="op">-</span> <span class="bu">set</span>(state_names))</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>extra_names2 <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(state_names) <span class="op">-</span> <span class="bu">set</span>(airport[<span class="st">'state'</span>]))</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># names in gapminder and in map data</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"in common:"</span>, <span class="bu">len</span>(common_names2), common_names2)     </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># names in gapminder but not in map data</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"missing state in map:"</span>, <span class="bu">len</span>(missing_names2), missing_names2)    </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># names in the map data but not in gapminder</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"extra state in map"</span>, <span class="bu">len</span>(extra_names2), extra_names2)  </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>state_dict <span class="op">=</span> {</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'KY'</span>: <span class="st">'Kentucky'</span>,</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NE'</span>: <span class="st">'Nebraska'</span>,</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'OH'</span>: <span class="st">'Ohio'</span>,</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ND'</span>: <span class="st">'North Dakota'</span>,</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PA'</span>: <span class="st">'Pennsylvania'</span>,</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NH'</span>: <span class="st">'New Hampshire'</span>,</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MN'</span>: <span class="st">'Minnesota'</span>,</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'VT'</span>: <span class="st">'Vermont'</span>,</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MA'</span>: <span class="st">'Massachusetts'</span>,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MD'</span>: <span class="st">'Maryland'</span>,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IN'</span>: <span class="st">'Indiana'</span>,</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">'VA'</span>: <span class="st">'Virginia'</span>,</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">'HI'</span>: <span class="st">'Hawaii'</span>,</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">'RI'</span>: <span class="st">'Rhode Island'</span>,</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'DC'</span>: <span class="st">'District of Columbia'</span>,</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NM'</span>: <span class="st">'New Mexico'</span>,</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TX'</span>: <span class="st">'Texas'</span>,</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NJ'</span>: <span class="st">'New Jersey'</span>,</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CA'</span>: <span class="st">'California'</span>,</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MI'</span>: <span class="st">'Michigan'</span>,</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AK'</span>: <span class="st">'Alaska'</span>,</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SC'</span>: <span class="st">'South Carolina'</span>,</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">'KS'</span>: <span class="st">'Kansas'</span>,</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GU'</span>: <span class="st">'Guam'</span>,</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CO'</span>: <span class="st">'Colorado'</span>,</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MT'</span>: <span class="st">'Montana'</span>,</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ME'</span>: <span class="st">'Maine'</span>,</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">'DE'</span>: <span class="st">'Delaware'</span>,</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">'WA'</span>: <span class="st">'Washington'</span>,</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CQ'</span>: <span class="st">'Commonwealth of the Northern Mariana Islands'</span>,</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CT'</span>: <span class="st">'Connecticut'</span>,</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PR'</span>: <span class="st">'Puerto Rico'</span>,</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AZ'</span>: <span class="st">'Arizona'</span>,</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NC'</span>: <span class="st">'North Carolina'</span>,</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">'UT'</span>: <span class="st">'Utah'</span>,</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NV'</span>: <span class="st">'Nevada'</span>,</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IA'</span>: <span class="st">'Iowa'</span>,</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MO'</span>: <span class="st">'Missouri'</span>,</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MS'</span>: <span class="st">'Mississippi'</span>,</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AL'</span>: <span class="st">'Alabama'</span>,</span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NY'</span>: <span class="st">'New York'</span>,</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GA'</span>: <span class="st">'Georgia'</span>,</span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SD'</span>: <span class="st">'South Dakota'</span>,</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>    <span class="st">'OK'</span>: <span class="st">'Oklahoma'</span>,</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AR'</span>: <span class="st">'Arkansas'</span>,</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LA'</span>: <span class="st">'Louisiana'</span>,</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AS'</span>: <span class="st">'American Samoa'</span>,</span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IL'</span>: <span class="st">'Illinois'</span>,</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ID'</span>: <span class="st">'Idaho'</span>,</span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">'WV'</span>: <span class="st">'West Virginia'</span>,</span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TN'</span>: <span class="st">'Tennessee'</span>,</span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">'FL'</span>: <span class="st">'Florida'</span>,</span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">'WI'</span>: <span class="st">'Wisconsin'</span>,</span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">'WY'</span>: <span class="st">'Wyoming'</span>,</span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">'OR'</span>: <span class="st">'Oregon'</span>,</span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">'VI'</span>: <span class="st">'United States Virgin Islands'</span></span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>airport[<span class="st">'state'</span>] <span class="op">=</span> airport[<span class="st">'state'</span>].replace(state_dict)</span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>airport</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['Alabama', 'Alaska', 'Arizona', 'Colorado', 'Florida']
in common: 0 []
missing state in map: 57 ['NY', 'SD', 'CA', 'IN', 'ND', 'ID', 'AL', 'IL', 'VT', 'MA', 'NH', 'WI', 'DC', 'MT', 'NV', 'AZ', 'NJ', 'NM', 'MS', 'GU', 'AS', 'OH', 'FL', 'LA', 'ME', 'CO', 'WA', 'NE', 'DE', 'MD', 'IA', 'NC', 'WY', 'PR', 'AR', 'AK', 'MI', 'KY', 'TX', 'CQ', 'MO', 'VA', 'PA', 'CT', 'KS', 'OK', 'OR', 'GA', 'HI', 'UT', 'RI', 'VI', 'MN', 'TN', nan, 'SC', 'WV']
extra state in map 56 ['Nebraska', 'Missouri', 'Kansas', 'American Samoa', 'Idaho', 'Texas', 'District of Columbia', 'Maryland', 'Michigan', 'Georgia', 'South Carolina', 'New Hampshire', 'Alabama', 'Wisconsin', 'New Jersey', 'Connecticut', 'Massachusetts', 'North Carolina', 'Wyoming', 'Arkansas', 'Utah', 'Virginia', 'Oregon', 'Colorado', 'Tennessee', 'Florida', 'Guam', 'South Dakota', 'Pennsylvania', 'Ohio', 'Kentucky', 'Vermont', 'North Dakota', 'California', 'Delaware', 'Hawaii', 'Minnesota', 'Montana', 'United States Virgin Islands', 'Washington', 'Louisiana', 'West Virginia', 'Oklahoma', 'Arizona', 'Illinois', 'New York', 'Indiana', 'Mississippi', 'Rhode Island', 'New Mexico', 'Puerto Rico', 'Nevada', 'Iowa', 'Alaska', 'Commonwealth of the Northern Mariana Islands', 'Maine']</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">iata</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">longitude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>00M</td>
<td>Thigpen</td>
<td>Bay Springs</td>
<td>Mississippi</td>
<td>USA</td>
<td>31.953765</td>
<td>-89.234505</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>00R</td>
<td>Livingston Municipal</td>
<td>Livingston</td>
<td>Texas</td>
<td>USA</td>
<td>30.685861</td>
<td>-95.017928</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>00V</td>
<td>Meadow Lake</td>
<td>Colorado Springs</td>
<td>Colorado</td>
<td>USA</td>
<td>38.945749</td>
<td>-104.569893</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>01G</td>
<td>Perry-Warsaw</td>
<td>Perry</td>
<td>New York</td>
<td>USA</td>
<td>42.741347</td>
<td>-78.052081</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>01J</td>
<td>Hilliard Airpark</td>
<td>Hilliard</td>
<td>Florida</td>
<td>USA</td>
<td>30.688012</td>
<td>-81.905944</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3371</td>
<td>ZEF</td>
<td>Elkin Municipal</td>
<td>Elkin</td>
<td>North Carolina</td>
<td>USA</td>
<td>36.280024</td>
<td>-80.786069</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3372</td>
<td>ZER</td>
<td>Schuylkill Cty/Joe Zerbey</td>
<td>Pottsville</td>
<td>Pennsylvania</td>
<td>USA</td>
<td>40.706449</td>
<td>-76.373147</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3373</td>
<td>ZPH</td>
<td>Zephyrhills Municipal</td>
<td>Zephyrhills</td>
<td>Florida</td>
<td>USA</td>
<td>28.228065</td>
<td>-82.155916</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3374</td>
<td>ZUN</td>
<td>Black Rock</td>
<td>Zuni</td>
<td>New Mexico</td>
<td>USA</td>
<td>35.083227</td>
<td>-108.791777</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3375</td>
<td>ZZV</td>
<td>Zanesville Municipal</td>
<td>Zanesville</td>
<td>Ohio</td>
<td>USA</td>
<td>39.944458</td>
<td>-81.892105</td>
</tr>
</tbody>
</table>

<p>3376 rows × 7 columns</p>
</div>
</div>
</div>
</section>
<section id="group-up-airports-by-state-to-get-the-count-of-airports-in-each-state" class="level3">
<h3 class="anchored" data-anchor-id="group-up-airports-by-state-to-get-the-count-of-airports-in-each-state">group up airports by state to get the count of airports in each state</h3>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group up airports by state to get the count of airports in each state</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>airport_count_per_state <span class="op">=</span> airport.groupby(<span class="st">'state'</span>).size().reset_index(name<span class="op">=</span><span class="st">'airport_count'</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>airport_count_per_state</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">airport_count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Alabama</td>
<td>73</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Alaska</td>
<td>263</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>American Samoa</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Arizona</td>
<td>59</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Arkansas</td>
<td>74</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>California</td>
<td>205</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Colorado</td>
<td>49</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Commonwealth of the Northern Mariana Islands</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Connecticut</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Delaware</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>District of Columbia</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>Florida</td>
<td>100</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Georgia</td>
<td>97</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>Guam</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>Hawaii</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>Idaho</td>
<td>37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>Illinois</td>
<td>88</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>Indiana</td>
<td>65</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>Iowa</td>
<td>78</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>Kansas</td>
<td>78</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>Kentucky</td>
<td>50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>Louisiana</td>
<td>55</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>Maine</td>
<td>34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>Maryland</td>
<td>18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>Massachusetts</td>
<td>30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>Michigan</td>
<td>94</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>Minnesota</td>
<td>89</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>Mississippi</td>
<td>72</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>Missouri</td>
<td>74</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>Montana</td>
<td>71</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>Nebraska</td>
<td>73</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>Nevada</td>
<td>32</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>New Hampshire</td>
<td>14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33</td>
<td>New Jersey</td>
<td>35</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34</td>
<td>New Mexico</td>
<td>51</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>New York</td>
<td>97</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">36</td>
<td>North Carolina</td>
<td>72</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">37</td>
<td>North Dakota</td>
<td>52</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>Ohio</td>
<td>100</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>Oklahoma</td>
<td>102</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>Oregon</td>
<td>57</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">41</td>
<td>Pennsylvania</td>
<td>71</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42</td>
<td>Puerto Rico</td>
<td>11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">43</td>
<td>Rhode Island</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">44</td>
<td>South Carolina</td>
<td>52</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">45</td>
<td>South Dakota</td>
<td>57</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">46</td>
<td>Tennessee</td>
<td>70</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">47</td>
<td>Texas</td>
<td>209</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">48</td>
<td>United States Virgin Islands</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">49</td>
<td>Utah</td>
<td>35</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50</td>
<td>Vermont</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">51</td>
<td>Virginia</td>
<td>47</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">52</td>
<td>Washington</td>
<td>65</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">53</td>
<td>West Virginia</td>
<td>24</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">54</td>
<td>Wisconsin</td>
<td>84</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">55</td>
<td>Wyoming</td>
<td>32</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="number-of-airport-in-each-state" class="level2">
<h2 class="anchored" data-anchor-id="number-of-airport-in-each-state">Number of airport in each state</h2>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>airport_map<span class="op">=</span> state_map.transform_lookup(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  lookup<span class="op">=</span><span class="st">'properties.name'</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  from_<span class="op">=</span>alt.LookupData(airport_count_per_state, <span class="st">'state'</span>, [<span class="st">'airport_count'</span>])</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  ).encode(</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    fill <span class="op">=</span> <span class="st">"airport_count:Q"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    stroke <span class="op">=</span> <span class="st">"airport_count:Q"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    ).properties(width <span class="op">=</span> <span class="dv">600</span>, height <span class="op">=</span> <span class="dv">400</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>airport_map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">

<style>
  #altair-viz-3da5cee640374ae4ad19baaaf0b967d6.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-3da5cee640374ae4ad19baaaf0b967d6.vega-embed details,
  #altair-viz-3da5cee640374ae4ad19baaaf0b967d6.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-3da5cee640374ae4ad19baaaf0b967d6"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-3da5cee640374ae4ad19baaaf0b967d6") {
      outputDiv = document.getElementById("altair-viz-3da5cee640374ae4ad19baaaf0b967d6");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"url": "https://cdn.jsdelivr.net/npm/us-atlas@3/states-10m.json", "format": {"feature": "states", "type": "topojson"}}, "mark": {"type": "geoshape", "fill": "transparent", "stroke": "steelblue"}, "encoding": {"fill": {"field": "airport_count", "type": "quantitative"}, "stroke": {"field": "airport_count", "type": "quantitative"}, "tooltip": [{"field": "properties.name", "type": "nominal"}, {"field": "airport_count", "type": "quantitative"}]}, "height": 400, "projection": {"type": "albersUsa"}, "transform": [{"lookup": "properties.name", "from": {"data": {"url": "altair-data-0bd58b3a9bf7f7c1e5ff516f10f5ab13.json", "format": {"type": "json"}}, "key": "state", "fields": ["airport_count"]}}], "width": 600, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json"}, {"mode": "vega-lite"});
</script>
</div>
</div>
<section id="question-3" class="level3">
<h3 class="anchored" data-anchor-id="question-3">Question 3</h3>
<p>What is the main story of this graphic?</p>
<p><a href="https://www.reddit.com/r/dataisbeautiful/comments/1axewof/oc_padel_clubs_generate_more_than_half_of_padel/">source</a> Just as it is written in the title, the graphic shows that Padel clubs generate more than half of the padel market revenue.</p>
<p>What makes it a good graphic?</p>
<p>The title tells the story of the graphic rather than just comparing the data such as “padel market revenue.” Following the title, the graphic is easy to read: since the padel club’s revenue box clearly is more than half of the entire box, we can easily read what the graphic is trying to convey without deep analysis. Since the data is hierarchically represented by nested rectangles, it is easy to read the overall composition and the hierarchy within the data without extra guide.</p>
<p>What features do you think you would know how to implement in Vega-lite?</p>
<p>I looked up treemaps in vegalite documentation, but I don’t think I can implement one with the things we’ve learned so far</p>
<p>Are there any features of the graphic that you would not know how to do in Vega-lite? If so, list them.</p>
<ol type="1">
<li><p>making treemap</p></li>
<li><p>putting images in the center of each box</p></li>
<li><p>using two titles, one for the main and one for the sub.</p></li>
</ol>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>